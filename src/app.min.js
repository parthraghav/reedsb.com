/* Author: Parth Raghav <raghavp@reed.edu> */
// File: app.min.js

!function(){function e(e,t,i="{{}}"){i.length%2&&console.error("invalid delimiter");for(var s=i.slice(0,i.length/2),n=i.slice(i.length/2,i.length),a=Object.keys(t),o=j=0;0<=e.indexOf(n)&&e.indexOf(n)<e.length;)o=e.indexOf(s),j=e.indexOf(n),key_found=e.slice(o+s.length,j),-1!=a.indexOf(key_found)?val=t[key_found]:val="",e=e.slice(0,o)+val+e.slice(j+n.length,e.length);return e}var t;t=function(e){"use strict";function t(e){var t=e.clone().css({height:"auto",width:e.width(),maxHeight:"none",overflow:"hidden"}).insertAfter(e),i=t.outerHeight(),s=parseInt(t.css({maxHeight:""}).css("max-height").replace(/[^-\d\.]/g,""),10),n=e.data("defaultHeight");t.remove();var a=s||e.data("collapsedHeight")||n;e.data({expandedHeight:i,maxHeight:s,collapsedHeight:a}).css({maxHeight:"none"})}function i(t,i){this.element=t,this.options=e.extend({},n,i),function(e){if(!a[e.selector]){var t=" ";e.embedCSS&&""!==e.blockCSS&&(t+=e.selector+" + [data-readmore-toggle], "+e.selector+"[data-readmore]{"+e.blockCSS+"}"),t+=e.selector+"[data-readmore]{transition: height "+e.speed+"ms;overflow: hidden;}",function(e,t){var i=e.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(e.createTextNode(t)),e.getElementsByTagName("head")[0].appendChild(i)}(document,t),a[e.selector]=!0}}(this.options),this._defaults=n,this._name=s,this.init(),window.addEventListener?(window.addEventListener("load",r),window.addEventListener("resize",r)):(window.attachEvent("load",r),window.attachEvent("resize",r))}var s="readmore",n={speed:100,collapsedHeight:200,heightMargin:16,moreLink:'<a href="#">Read More</a>',lessLink:'<a href="#">Close</a>',embedCSS:!0,blockCSS:"display: block; width: 100%;",startOpen:!1,blockProcessed:function(){},beforeToggle:function(){},afterToggle:function(){}},a={},o=0,r=function(e,t,i){var s;return function(){var n=this,a=arguments,o=i&&!s;clearTimeout(s),s=setTimeout(function(){s=null,i||e.apply(n,a)},t),o&&e.apply(n,a)}}(function(){e("[data-readmore]").each(function(){var i=e(this),s="true"===i.attr("aria-expanded");t(i),i.css({height:i.data(s?"expandedHeight":"collapsedHeight")})})},100);i.prototype={init:function(){var i=e(this.element);i.data({defaultHeight:this.options.collapsedHeight,heightMargin:this.options.heightMargin}),t(i);var s=i.data("collapsedHeight"),n=i.data("heightMargin");if(i.outerHeight(!0)<=s+n)return this.options.blockProcessed&&"function"==typeof this.options.blockProcessed&&this.options.blockProcessed(i,!1),!0;var a=i.attr("id")||function(e){var t=++o;return String(null==e?"rmjs-":e)+t}(),r=this.options.startOpen?this.options.lessLink:this.options.moreLink;i.attr({"data-readmore":"","aria-expanded":this.options.startOpen,id:a}),i.after(e(r).on("click",function(e){return function(t){e.toggle(this,i[0],t)}}(this)).attr({"data-readmore-toggle":a,"aria-controls":a})),this.options.startOpen||i.css({height:s}),this.options.blockProcessed&&"function"==typeof this.options.blockProcessed&&this.options.blockProcessed(i,!0)},toggle:function(t,i,s){s&&s.preventDefault(),t||(t=e('[aria-controls="'+this.element.id+'"]')[0]),i||(i=this.element);var n=e(i),a="",o="",r=!1,l=n.data("collapsedHeight");n.height()<=l?(a=n.data("expandedHeight")+"px",o="lessLink",r=!0):(a=l,o="moreLink"),this.options.beforeToggle&&"function"==typeof this.options.beforeToggle&&this.options.beforeToggle(t,n,!r),n.css({height:a}),n.on("transitionend",function(i){return function(){i.options.afterToggle&&"function"==typeof i.options.afterToggle&&i.options.afterToggle(t,n,r),e(this).attr({"aria-expanded":r}).off("transitionend")}}(this)),e(t).replaceWith(e(this.options[o]).on("click",function(e){return function(t){e.toggle(this,i,t)}}(this)).attr({"data-readmore-toggle":n.attr("id"),"aria-controls":n.attr("id")}))},destroy:function(){e(this.element).each(function(){var t=e(this);t.attr({"data-readmore":null,"aria-expanded":null}).css({maxHeight:"",height:""}).next("[data-readmore-toggle]").remove(),t.removeData()})}},e.fn.readmore=function(t){var n=arguments,a=this.selector;return"object"==typeof(t=t||{})?this.each(function(){if(e.data(this,"plugin_"+s)){var n=e.data(this,"plugin_"+s);n.destroy.apply(n)}t.selector=a,e.data(this,"plugin_"+s,new i(this,t))}):"string"==typeof t&&"_"!==t[0]&&"init"!==t?this.each(function(){var a=e.data(this,"plugin_"+s);a instanceof i&&"function"==typeof a[t]&&a[t].apply(a,Array.prototype.slice.call(n,1))}):void 0}},"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery),function(){COLORS=[["#FF9800","#A52A2A","#5F9EA0","#FF7F50"],["#EF5350","#7E57C2","#2196F3","#00BCD4","#009688","#CDDC39","#808080","#FFC0CB"],["#9acd32","#ee82ee","#ff6347","#008080","#009688","#6a5acd","#4169e1"]],function(e){var t=[].concat.apply([],e),i=document.getElementsByClassName("colored-sin-item");if(i.length){for(var s=0,n=i.length;s<n;s++)i[s].style.borderColor=t[s]}}(COLORS)}(),String.prototype.hexEncode=function(){var e,t="";for(e=0;e<this.length;e++)t+=("000"+this.charCodeAt(e).toString(16)).slice(-4);return t},String.prototype.hexDecode=function(){var e,t=this.match(/.{1,4}/g)||[],i="";for(e=0;e<t.length;e++)i+=String.fromCharCode(parseInt(t[e],16));return i};const i=firebase,s={rcopens:new Date("Jan 1 2020 23:59:59").getTime(),rcends:new Date("Feb 1 2020 23:59:59").getTime(),rfsopens:new Date("Jun 1 2020 23:59:59").getTime(),rfsends:new Date("Jul 1 2020 23:59:59").getTime(),fpopens:new Date("Oct 11 2020 23:59:59").getTime(),fpends:new Date("Oct 20 2020 23:59:59").getTime(),seopens:new Date("Oct 21 2020 19:47:59").getTime(),seends:new Date("Oct 22 2020 21:47:59").getTime(),campaign_max_length:250,campaign_min_length:25,secampaign:"se-test-2020-1Axbu2VnDYrzxt1GWZsw",prev_campaigns:["se-fall-2019-COrYlp5YXN5ZvUuzpsJq"],poll_id:"1Axbu2VnDYrzxt1GWZsw",senate_dat_file:"",prev_senate_dat_files:["fall-2019-senate-members"],prev_polls:["fall-2019-UPWlKMYkvCd2fuXY6Rce","fp-spring-2020-1cW4NmL7sfo0rOqAK5ro"],poll_name:"fp-test-2020-2dW4NmL7sfo0rOqAK5ro",semester:"spring-2021",max_boosts:6,vote_submission_threshold:.01,authorised_users:["raghavp@reed.edu","trouts@reed.edu","taqia@reed.edu","enahashim@reed.edu","anachebk@reed.edu","cunningk@reed.edu","aziouedra@reed.edu"],direct_server_load:!0,bypass_full_id_app:!0};class n{constructor(){this.FIREBASECONFIG={apiKey:"AIzaSyBvWLtRYPBN0qKj_K30p1sY3vOS2hFAzQQ",authDomain:"sin-reed-edu.firebaseapp.com",databaseURL:"https://sin-reed-edu.firebaseio.com",projectId:"sin-reed-edu",storageBucket:"",messagingSenderId:"922484667339",appId:"1:922484667339:web:cb8e7c755f42c286"},this.DEBUG_MODE=!0,this.login_state=0,i.initializeApp(this.FIREBASECONFIG),this.auth=i.auth(),this.db=i.firestore(),this.view=this.get_view(),this.mobile=u.is_mobile(),this.__defineHandlers__()}get_view(){var e=window.location.pathname.split("/").pop();return e.indexOf(".")>-1?e.split(".").slice(0,-1).join("."):""==e?"index":e}__defineHandlers__(){self=this,this.auth.onAuthStateChanged(function(e){null==e?this.login_state=0:(this.unsafe_user=e,this.primary=new p(e),this.login_state=1),this.refresh_view(e)}.bind(self))}login(){let e=new i.auth.GoogleAuthProvider;e.setCustomParameters({hd:"reed.edu"}),i.auth().signInWithRedirect(e)}logout(){self=this,i.auth().signOut().then(void 0).catch(function(e){})}check_admin_status(){}initialise_view(e){this.refresh_view(e)}refresh_view(e){var t,i,n,a,o,r;if(t=this,$("#act-login").click(()=>t.login()),$(".act-login").click(function(e){e.preventDefault(),t.login()}),$("#act-logout").click(()=>t.logout()),this.is_view("funding-poll")||this.is_view("senate-election")){if(this.is_view("funding-poll")){var l=(new Date).getTime()<s.fpopens&&(new Date).getTime()>s.fpends;l&&($("#sin-fp-timeout-alert").show(),console.log("Results are announced"),this.view_funding_poll_results()),e?($("#sin-fp-name").text(this.auth.currentUser.displayName.replace(/ .*/,"")),$("#sin-fp-login-alert").hide(),l||($("#sin-fp-timeout-alert").hide(),this.funding_poll())):($("#sin-fp-login-alert").show(),$("#preloader-screen").hide(),$("#intro-screen").hide(),$("#voting-screen").hide())}else if(this.is_view("senate-election")){var d=(new Date).getTime()>s.seopens&&(new Date).getTime()>s.seends;d&&($("#sin-se-timeout-alert").show(),console.log("Results are announced"),this.view_senate_election_results()),e?($("#sin-se-name").text(this.auth.currentUser.displayName.replace(/ .*/,"")),$("#sin-se-login-alert").hide(),d||($("#sin-se-timeout-alert").hide(),this.senate_election())):($("#sin-se-login-alert").show(),$("#preloader-screen").hide(),$("#intro-screen").hide(),$("#voting-screen").hide())}}else{h.ActivateTouchDown(),h.ActivateStickyHeader(),h.ActivateHoverFluid();const t=document.querySelectorAll(".lo"),i=document.querySelectorAll(".li:not(.ad)");document.querySelectorAll(".ad");if(e?(i.forEach(e=>{e.classList.remove("d-none"),e.classList.add("d-inline-block")}),t.forEach(e=>{e.classList.remove("d-inline-block"),e.classList.add("d-none")})):(i.forEach(e=>{e.classList.remove("d-inline-block"),e.classList.add("d-none")}),t.forEach(e=>{e.classList.remove("d-none"),e.classList.add("d-inline-block")})),e){const e=document.querySelector("#user-nav-profile-photo"),t=document.querySelector("#user-nav-display-name");e.src=this.auth.currentUser.photoURL,e.alt=this.auth.currentUser.displayName,t.innerText=this.auth.currentUser.displayName.replace(/ .*/,"")}}if(this.is_view("team"))try{$.ajax({dataType:"json",url:"./data/"+s.senate_dat_file+".json",data:{},success:function(e){var t=e;h.resolveListRepeats(t.LIST,{contact:function(e){e.split(",").forEach(function(e){return-1!=e.indexOf("email")&&e.match(/\(([^)]+)\)/)[1],e})}}),$("#sin-tm-collection").removeClass("d-none")},error:function(e){console.log(e)}})}catch(e){console.log(e)}this.is_view("register-club")?(i=$("#sin-rc-alert"),n=$("#sin-rc-form"),a=$("#sin-rc-alert-timeout"),e?(new Date).getTime()<s.rcopens&&(new Date).getTime()>s.rcends?(a[0].classList.remove("d-none"),a[0].classList.add("d-block"),n[0].classList.remove("d-block"),n[0].classList.add("d-none")):(this.club_register(),i[0].classList.add("d-none"),i[0].classList.remove("d-block"),n[0].classList.remove("d-none"),n[0].classList.add("d-block")):(i[0].classList.remove("d-none"),i[0].classList.add("d-block"),n[0].classList.add("d-none"),n[0].classList.remove("d-block"))):this.is_view("request-funds")?(this.fund_request(),i=$("#sin-rf-alert"),n=$("#sin-rf-form"),e?(i[0].classList.add("d-none"),i[0].classList.remove("d-block"),n[0].classList.remove("d-none"),n[0].classList.add("d-block")):(i[0].classList.remove("d-none"),i[0].classList.add("d-block"),n[0].classList.add("d-none"),n[0].classList.remove("d-block"))):this.is_view("dash-door")?(i=$("#sin-dd-alert"),o=$("#sin-dd-viewer"),r=$("#sin-dd-alert-auth"),e?(i[0].classList.add("d-none"),i[0].classList.remove("d-block"),s.authorised_users.includes(e.email)?(r[0].classList.add("d-none"),r[0].classList.remove("d-block"),this.dash_door(),o[0].classList.remove("d-none"),o[0].classList.add("d-block")):(r[0].classList.add("d-block"),r[0].classList.remove("d-none"),o[0].classList.add("d-none"),o[0].classList.remove("d-block"))):(i[0].classList.remove("d-none"),i[0].classList.add("d-block"),o[0].classList.add("d-none"),o[0].classList.remove("d-block"))):this.is_view("run-for-senate")&&(i=$("#sin-rfs-alert"),n=$("#sin-rfs-form"),a=$("#sin-rfs-alert-timeout"),e?(new Date).getTime()<s.rfsopens&&(new Date).getTime()>s.rfsends?(a[0].classList.remove("d-none"),a[0].classList.add("d-block"),n[0].classList.remove("d-block"),n[0].classList.add("d-none")):(this.run_for_senate(),i[0].classList.add("d-none"),i[0].classList.remove("d-block"),n[0].classList.remove("d-none"),n[0].classList.add("d-block")):(i[0].classList.remove("d-none"),i[0].classList.add("d-block"),n[0].classList.add("d-none"),n[0].classList.remove("d-block")))}is_view(e){return this.DEBUG_MODE&&this.view==e||!this.DEBUG_MODE&&this.view==e+".php"}club_register(){if(this.is_view("register-club")){var e=[];this.db.collection("signatories").doc(s.semester).get().then(function(t){var i=t.data();e=i.signatories}).then(function(){u.make_signator_selector("#sin-rc-choose-signator",e)});var t=this;$("#sin-rc-form-submit").click(function(n){n.preventDefault();var a=$("#sin-rc-choose-signator")[0].value,o=$("#sin-rc-org-name")[0].value,r=$("#sin-rc-contact")[0].value,l=$("#sin-rc-about")[0].value,d=$("#sin-rc-poll-participate-0")[0].checked,c=$("#sin-rc-identity-status-flag-0")[0].checked,u=$("#sin-rc-identity-mission")[0].value,h=$("#sin-rc-identity-community")[0].value,p=$("#sin-rc-identity-activity")[0].value,m=$("#sin-rc-identity-open")[0].value,f=$("#sin-rc-identity-outside-funding")[0].value;if(function(t,i,n,a,o,r,l,d,c,u){if(0==t.length)return alert("Unauthorised, invalid, or empty signators"),!1;t.split(",").reduce((t,i)=>t&&e.reduce((e,t)=>t.Email==i),1);for(var h=e.map(e=>e.Email),p=[],m=0;m<t.split(",").length;m++)p.push(h.includes(t.split(",")[m]));if(!(t.length>0&&p.reduce((e,t)=>e&&t)))return alert("Unauthorised, invalid, or empty signators"),!1;if(i.length<3||i.length>50)return alert("too long or too short title"),!1;if(-1==n.indexOf("@"))return alert("Please provide emails for the points of contact."),!1;if(a.split(" ").length>130||a.split(" ").length<4)return alert("too long or too short description"),!1;if(o){var f=r.split(" ");if(300>f.length||f.length>550)return alert(" Mission statement under or above word limit. "),!1;var g=l.split(" ");if(!s.bypass_full_id_app&&(200>g.length||g.length>400))return alert(" Prompt II under or above word limit. "),!1;var v=d.split(" ");if(!s.bypass_full_id_app&&(100>v.length||v.length>300))return alert(" Prompt III under or above word limit. "),!1;var b=c.split(" ");if(!s.bypass_full_id_app&&(50>b.length||b.length>300))return alert(" Prompt IV under or above word limit. "),!1}return!0}(a,o,r,l,c,u,h,p,m)){var g={about:l,contact:r,signators:a,title:o,poll_participate:d,identity_request:c,review_status:0,votes:0,liked:0,disliked:0,boosted:0};c&&(g.identity_mission=u,g.identity_community=""==h&&s.bypass_full_id_app?"Not submitted":h,g.identity_activity=""==p&&s.bypass_full_id_app?"Not submitted":p,g.identity_open=""==m&&s.bypass_full_id_app?"Not submitted":m,g.identity_outsidefunding=""==f&&s.bypass_full_id_app?"Not submitted":f),t.db.collection("registered_clubs").doc(s.semester).update({registered_clubs:i.firestore.FieldValue.arrayUnion(g)}).then(function(){alert("Your club registration request has been received. Thank you for applying."),window.location.href=document.referrer}).catch(function(e){t.DEBUG_MODE&&console.error("error in club_register module",e)})}});t=this;var n=$("#sin-rc-id-only");$("#sin-rc-identity-status-flag-0").change(function(){this.checked?(n[0].classList.remove("d-none"),n[0].classList.add("d-block")):(n[0].classList.add("d-none"),n[0].classList.remove("d-block"))})}}fund_request(){if(this.is_view("request-funds")){var e=this,t=$("#sin-rf-purpose"),n=($("#sin-rf-reserve"),$("#when-signator")),a=$("#when-organisation");u.make_purpose_selector("#sin-rf-purpose"),u.make_reserve_selector("#sin-rf-reserve"),u.itemiser(),t.on("change",function(){0<this.value<=3?(n[0].classList.remove("d-none"),n[0].classList.add("d-inline-block")):(n[0].classList.add("d-none"),n[0].classList.remove("d-inline-block")),1==this.value?(a[0].classList.remove("d-none"),a[0].classList.add("d-inline-block")):(a[0].classList.add("d-none"),a[0].classList.remove("d-inline-block"))});var o=[];this.db.collection("signatories").doc(s.semester).get().then(function(e){var t=e.data();o=t.signatories}).then(function(){u.make_signator_selector("#sin-rf-choose-signator",o)});var r=[];this.db.collection("registered_clubs").get().then(function(e){e.forEach(function(e){r.push(e.data()),r[r.length-1].Private_doc_id=e.id})}).then(function(){u.make_organisation_selector("#sin-rf-choose-organisation",r)});var l=["Identity Funds","Student Body Funds","Finance Committee"],d=["Club/Organisation Funding","Community Event","Community Project"],c=["Refreshments","Administration","Entertainment","Capital Improvements","A/V","Miscellaneous"];$("#sin-rf-form-submit").click(function(t){t.preventDefault();var n=$("#sin-rf-reserve"),a=$("#sin-rf-purpose"),u=$("#sin-rf-choose-signator"),h=$("#sin-rf-choose-organisation"),p=$("#sin-rf-elaborate-purpose"),m=$("#sin-rf-budget-form>div:not(#sin-rf-item-header):not(#sin-rf-empty-cart):not(#sin-rf-item-footer)"),f=$("#sin-rf-certification-0"),g=$("#sin-rf-certification-1"),v=d[a.val()-1],b=l[n.val()-1],_=u.val(),w=h.val(),y=p.val(),x=[];m.each(function(){var e={item:$(this).find(".sin-rf-item-name").val(),category:c[$(this).find(".sin-rf-item-category").val()-1],amount:$(this).find(".sin-rf-item-cost").val()};x.push(e)});var k=[f[0].checked,g[0].checked];if(function(e,t,i,s,n,a,u){if(!d.includes(e))return alert('Either you have not selected the "purpose" or tampered with the parameters. Please select the "purpose". The form remains unsubmitted.'),!1;if(!l.includes(t))return alert('Either you have not selected the "reserve" or tampered with the parameters. Please select the "reserve". The form remains unsubmitted.'),!1;if(0==i.length)return alert("Unauthorised, invalid, or empty signators"),!1;i.split(",").reduce((e,t)=>e&&o.reduce((e,i)=>i.Email==t),1);for(var h=o.map(e=>e.Email),p=[],m=0;m<i.split(",").length;m++)p.push(h.includes(i.split(",")[m]));if(!(i.length>0&&p.reduce((e,t)=>e&&t)))return alert("Unauthorised, invalid, or empty signators"),!1;if(e==d[0]&&!r.find(e=>e.title==s))return alert("Your organisation must first be registered."),!1;var f=n.split(" ").length;if(0==f||f>=150)return alert("Length of the purpose description should be greater than 0, but less than 150 words."),!1;if(0==a.length)return alert("There are no items in your budget. Add at least one item to continue."),!1;for(m=0;m<a.length;m++){if(!(0<a[m].item.split(" ").length<50))return alert("Item description of item "+(m+1)+" is either empty or longer than 50 words."),!1;if(!c.includes(a[m].category))return alert("Item category of item "+(m+1)+" is either not selected or invalid."),!1;if(!$.isNumeric(a[m].amount))return alert("Error in price amount of item "+(m+1)),!1}return u[0]?!!u[1]||(alert("Please complete the certification 2. The form remains unsubmitted."),!1):(alert("Please complete the certification 1. The form remains unsubmitted."),!1)}(v,b,_,w,y,x,k)){var C={time:(new Date).getTime(),purpose:v,reserve:b,signators:_,description:y,budget:x,review_status:0};C.purpose==d[0]&&(C.organisation=w);var F=e.db.collection("fund_requests").doc(s.semester);F.get().then(t=>{t.exists?F.onSnapshot(function(t){F.update({fund_requests:i.firestore.FieldValue.arrayUnion(C)}).then(function(){alert("Your fund request was successfully submitted. Thank you!"),window.location.href=document.referrer}).catch(function(t){e.DEBUG_MODE&&console.error("error in fund_request module",t)})}):F.set({fund_requests:i.firestore.FieldValue.arrayUnion(C)}).then(function(){alert("Your fund request was successfully submitted. Thank you!"),window.location.href=document.referrer}).catch(function(t){e.DEBUG_MODE&&console.error("error in fund_request module",t)})})}}.bind(this))}}funding_poll(){var e=this;function t(){$("#sin-fp-double-alert").hide();new c(e)}this.db.collection("users_who_have_voted").doc(s.poll_name+"-"+s.poll_id).get().then(function(i){var s=i.data();null!=s&&null!=s.voters?s.voters.forEach(function(i){i.Email==e.auth.currentUser.email?$("#sin-fp-double-alert").show():t()}):t()})}dash_door(){var e,t;e=$("#club_viewer"),t=$("#budgets_viewer");$("#sin-dd-refresh").click(function(){window.localStorage.setItem("cached2",!1),window.location.reload()});var i,n,a=[],o=[];function r(t){var s=e.DataTable({data:t,select:"single",columnDefs:[{searchable:!1,orderable:!1,targets:0}],columns:[{data:null},{className:"details-control",orderable:!1,data:null,defaultContent:"",render:function(){return'<i class="fa fa-plus-square" aria-hidden="true"></i>'},width:"15px"},{data:"title"},{data:"signators",orderable:!1,render:function(e){var t=u.shuffle(["primary"]),i="",s=0;return e.split(",").forEach(function(e){i+='<span class="badge badge-pill badge-'+t[s%t.length]+'">'+e+"</span> ",s+=1}),i}},{data:"votes"},{data:"identity_request",orderable:!1,render:function(e){return 1==e?'<i class="fa fa-info-circle text-info" aria-hidden="true"></i>':'<i class="" aria-hidden="true"></i>'}},{data:"poll_participate",orderable:!1,render:function(e){return 1==e?'<i class="fas fa-poll text-warning" aria-hidden="true"></i>':'<i class="fas fa-poll text-dark" aria-hidden="true"></i>'}},{data:"review_status",orderable:!1,render:function(e){return 0==(e=parseInt(e))?'<i class="fa fa-circle text-danger" aria-hidden="true"></i>':1==e?'<i class="fa fa-check text-success" aria-hidden="true"></i>':void 0}}],order:[[2,"asc"]]});return $("#club_viewer tbody").on("click","td.details-control",function(){var e=$(this).closest("tr"),t=e.find("i.fa"),s=i.row(e);if(s.child.isShown())s.child.hide(),e.removeClass("shown"),t.first().removeClass("fa-minus-square"),t.first().addClass("fa-plus-square");else{var n=$(e).children()[0].textContent;s.child(u.format_club_row(s.data(),n)).show(),e.addClass("shown"),t.first().removeClass("fa-plus-square"),t.first().addClass("fa-minus-square")}$(".fin-dd-read-more").readmore({speed:75,lessLink:'<a href="#">Read less</a>'})}),s.on("user-select",function(e,t,i,s,n){$(s.node()).hasClass("details-control")&&e.preventDefault()}),s.on("order.dt search.dt",function(){s.column(0,{search:"applied",order:"applied"}).nodes().each(function(e,t){e.innerHTML=t+1})}).draw(),s}"true"==window.localStorage.cached2?i=r(JSON.parse(window.localStorage.getItem("fb_data"))):this.db.collection("registered_clubs").doc(s.semester).get().then(function(e){a=e.data().registered_clubs}).then(function(){window.localStorage.setItem("fb_data",JSON.stringify(a)),window.localStorage.setItem("cached2",!0),i=r(a)}),this.db.collection("fund_requests").doc(s.semester).get().then(function(e){var t=e.data();null!=t&&t.fund_requests.forEach(function(e){e.total=e.budget.reduce(function(e,t){return{amount:Math.round(Number(parseFloat(e.amount).toFixed(2))+Number(parseFloat(t.amount).toFixed(2)))}}).amount,o.push(e)})}).then(function(){n=function(e){$.fn.dataTableExt.oSort["timesort-desc"]=function(e,t){return(e=parseInt(e))>(t=parseInt(t))?-1:1},$.fn.dataTableExt.oSort["timesort-asc"]=function(e,t){return(e=parseInt(e))>(t=parseInt(t))?1:-1},jQuery.extend(jQuery.fn.dataTableExt.oSort,{"currency-pre":function(e){return e="-"===e?0:e.replace(/[^\d\-\.]/g,""),parseFloat(e)},"currency-asc":function(e,t){return e-t},"currency-desc":function(e,t){return t-e}});var i=t.DataTable({data:e,select:"single",columnDefs:[{searchable:!1,orderable:!1,targets:0},{type:"currency",targets:4}],columns:[{data:null},{className:"details-control",orderable:!1,data:null,defaultContent:"",render:function(){return'<i class="fa fa-plus-square" aria-hidden="true"></i>'},width:"15px"},{data:"organisation",render:function(e){return null==e?"Individual":e}},{data:"signators",orderable:!1,render:function(e){var t=u.shuffle(["primary"]),i="",s=0;return e.split(",").forEach(function(e){i+='<span class="badge badge-pill badge-'+t[s%t.length]+'">'+e+"</span> ",s+=1}),i}},{data:"total",orderable:!0,render:function(e){return("$"+e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"/-"}},{data:"reserve",orderable:!0},{data:"purpose",orderable:!0},{data:"time",orderable:!0,type:"date",render:function(e){var t=new Date(e),i=t.getFullYear();return`${("0"+(t.getMonth()+1)).slice(-2)}/${("0"+t.getDate()).slice(-2)}/${i} ${("0"+t.getHours()).slice(-2)}:${("0"+t.getMinutes()).slice(-2)}`}},{data:"review_status",orderable:!1,render:function(e){return 0==(e=parseInt(e))?'<i class="fa fa-circle text-danger" aria-hidden="true"></i>':1==e?'<i class="fa fa-check text-success" aria-hidden="true"></i>':void 0}}],order:[[2,"asc"]]});return $("#budgets_viewer tbody").on("click","td.details-control",function(){var e=$(this).closest("tr"),t=e.find("i.fa"),i=n.row(e);i.child.isShown()?(i.child.hide(),e.removeClass("shown"),t.first().removeClass("fa-minus-square"),t.first().addClass("fa-plus-square")):(i.child(u.format_budget_row(i.data())).show(),e.addClass("shown"),t.first().removeClass("fa-plus-square"),t.first().addClass("fa-minus-square")),$(".fin-dd-read-more").readmore({speed:75,lessLink:'<a href="#">Read less</a>'})}),$(document).on("click",".shoot_email",function(){var e,t=$(this).closest(".input-group").find("input").val();e=""==t||0==parseInt(t)?encodeURIComponent("We regret to inform you that the Senate has decided NOT to allocate any funds.\n\nOnwards,\nTreasury"):encodeURIComponent(`Congratulations! You have been allocated $${t}/-.\n\nOnwards,\nTreasury`),window.open($(this).attr("data-link")+e,"_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes")}),i.on("user-select",function(e,t,i,s,n){$(s.node()).hasClass("details-control")&&e.preventDefault()}),i.on("order.dt search.dt",function(){i.column(0,{search:"applied",order:"applied"}).nodes().each(function(e,t){e.innerHTML=t+1})}).draw(),i}(o)});var l={},d=this;this.db.collection("signatories").doc(s.semester).get().then(function(e){var t=e.data();null!=t&&t.signatories.filter(function(e){return null!=e.Email}).forEach(function(e){$("#sList").append($("<option>").text(e.Name+", "+e.Email)),l[e.Email]=e.Name})}),$("#add-signators").click(function(){var e=$("#signatorsList").val(),t=[],i=[];if(e.split("\n").forEach(function(e){var s=e.split(",");null!=s[0]&&null!=s[1]?(s[0]=s[0].trim(),s[1]=s[1].trim(),null==l[s[1]]?t.push(s):i.push(s)):alert("Invalid delimiter")}),0==i.length){var n=[];t.forEach(function(e){n.push({Name:e[0],Email:e[1]})});var a=Object.entries(l).map(function(e){return{Name:e[1],Email:e[0]}}).concat(n);$(".alert-area").empty(),d.db.collection("signatories").doc(s.semester).set({signatories:a}).then(function(){alert("Signators added to the database"),window.location.reload()})}else{var o=i.map(e=>"<li>"+e[0]+", &lt;"+e[1]+"&gt;</li>").join(""),r=$(`<div class="alert alert-danger" role="alert">\n                  <h4 class="alert-heading">Duplicates detected!</h4>\n                  <p>Following signators already exist in the database, please remove them from the list.</p>\n                  <hr>\n                  ${o}\n                </div>`);$(".alert-area").empty(),$(".alert-area").append(r)}})}view_funding_poll_results(){var e={results:[]};function t(e){if(u.is_mobile()){var t=$("#sin-fp-results-graphic"),i=$("<img>").attr({src:"http://reedsb.com/data/mobile_results_fall2019_sb_fp.png",width:"100%"});t.append(i)}else u.visualise_results(e)}s.direct_server_load?this.db.collection("registered_clubs").where("poll_participate","==",!0).get().then(function(t){t.forEach(function(t){var i=t.data();e.results.push({title:i.title,votes:i.votes})})}).then(function(){t(e.results)}):$.ajax({dataType:"json",url:"./data/"+s.poll_name+"-"+s.poll_id+"-results.json",data:{},success:function(e){t(e.results.slice(0,e.results.length))},error:function(e){console.log(e)}}),u.congratulatory_confetti(),$("#sin-fp-timeout-alert .jumbotron-alert").click(function(){window.location.href="http://reedsb.com/en-us/request-funds.php"})}run_for_senate(){if(this.is_view("run-for-senate")){var e=this;$("#sin-rfs-form-name").attr("placeholder",this.unsafe_user.displayName).val(this.unsafe_user.displayName).focus().blur();var t,n,a=[];this.db.collection("elections").doc(s.secampaign).get().then(function(e){var t=e.data();null!=t&&(a=t.senate_positions)}).then(function(){u.make_senate_position_selector("#sin-rfs-form-position",a)}),t=$("#sin-rfs-form-campaign-msg"),n=$("#sin-rfs-campaign-prog"),t.bind("input propertychange",function(){var e=$("#sin-rfs-campaign-info"),t=this.value.length,i=s.campaign_max_length,a=s.campaign_min_length;this.value.length>0?(n.css("height","5px"),n.find("div").css("width",parseInt(100*t/i)+"%"),e.show(),e.text(`${t}/${i}`)):(n.css("height","5px"),e.hide(),e.text("0/"+i)),t>i||t<a?(n.find("div").addClass("bg-danger"),e.addClass("text-danger"),e.hide(),t>i&&e.text(`You can only write upto ${i} characters.`),t<a&&e.text(`${t}/${i} (You should write at least ${a} characters.)`),e.show()):(n.find("div").removeClass("bg-danger"),e.removeClass("text-danger"),e.show(),e.text(`${t}/${i}`))}),$("#sin-rfs-form-submit").click(function(t){t.preventDefault();var n=e.unsafe_user.displayName,o=$("input[name='sin-rfs-form-year']:checked").val(),r=$("#sin-rfs-form-position").val(),l=$("#sin-rfs-form-campaign-msg").val(),d=$("#sin-rfs-form-certification-0").is(":checked")&&$("#sin-rfs-form-certification-1").is(":checked")&&$("#sin-rfs-form-certification-2").is(":checked")&&$("#sin-rfs-form-certification-3").is(":checked")&&$("#sin-rfs-form-certification-4").is(":checked"),c={name:n,photoURL:e.auth.currentUser.photoURL,school_year:parseInt(o),senate_position:r,campaign_msg:l,certifications:d,votes:0,campaign:s.secampaign,registered:i.firestore.FieldValue.serverTimestamp()};(function(e){return[0,1,2,3].includes(parseInt(e.school_year))?""==e.senate_position?(alert("Invalid senate position"),!1):e.campaign_msg.length>s.campaign_max_length||e.campaign_msg.length<s.campaign_min_length?(alert("Spiel too long/too short."),!1):!!e.certifications||(alert("Please check all the certifications."),!1):(console.log(typeof e.school_year),alert("Invalid school year"),!1)})(c)&&e.db.collection("nominations").doc(s.secampaign).update({nominations:i.firestore.FieldValue.arrayUnion(c)}).then(function(t){var i;i=a.find(e=>e.Role==c.senate_position)?a.map(function(e){return e.Role==c.senate_position&&(e.Role=c.senate_position,e.Count=e.Count+1),e}):a.concat([{Role:c.senate_position,Primary:!1,Count:0}]),e.db.collection("elections").doc(s.secampaign).set({senate_positions:i},{merge:!0}).then(function(e){alert("Your senate nomination was successfully submitted. Thank you!"),window.location.href=document.referrer}).catch(function(t){e.DEBUG_MODE&&console.error("error in run_for_senate module",t)})}).catch(function(t){e.DEBUG_MODE&&console.error("error in run_for_senate module",t)})})}}senate_election(){var e=this;this.db.collection("users_who_have_voted").doc(s.secampaign).where("Email","==",this.auth.currentUser.email).get().then(function(t){0==t.size?($("#sin-se-double-alert").hide(),new r(e).begin()):t.size>=1&&$("#sin-se-double-alert").show()})}view_senate_election_results(){}}function a(e){e.removeClass("d-none")}function o(e){e.addClass("d-none")}class r{constructor(e){this.nominee_data=[],this.results={},this.app=e,this.intro_screen=$("#intro-screen"),this.vote_how_el=$("#se-vote-how"),this.vote_done_el=$("#se-vote-done"),this.vote_screen=$("#se-voter"),this.preloader_screen=$("#preloader-screen"),this.voting_index=-1,this.fix_cursor()}begin(){this._intro_screen()}fix_cursor(){$("button").on("mouseover",function(){$(this).addClass("click-cursor")}),$("button").on("mouseout",function(){$(this).removeClass("click-cursor")}),$("button").on("mousedown",function(){$(this).removeClass("click-cursor"),$(this).addClass("click-md-cursor")}),$("button").on("mouseup",function(){$(this).removeClass("click-md-cursor"),$(this).addClass("click-cursor")}),$(".grabbable").on("mouseover",function(){$(this).addClass("sin-se-item-interacted"),$(this).addClass("draggable-cursor")}),$(".grabbable").on("mouseout",function(){Boolean($(this).attr("clicked"))||$(this).removeClass("sin-se-item-interacted"),$(this).removeClass("draggable-cursor")}),$(".grabbable").click(function(){$(".grabbable").removeClass("sin-se-item-interacted"),$(".grabbable").removeAttr("clicked"),$(this).addClass("sin-se-item-interacted"),$(this).attr("clicked",!0),console.log($(this).attr("clicked"))}),$("body").addClass("auto-cursor")}_intro_screen(){var e=this;a(this.intro_screen),o(this.vote_how_el),o(this.vote_done_el),o(this.vote_screen),o(this.preloader_screen),this.app.db.collection("elections").get().then(function(t){t.forEach(function(t){var i=t.data();e.senate_positions=i.senate_positions,e.users_who_have_voted=i.users_voted})}).then(function(){$("#sin-se-voter-count").text(e.users_who_have_voted),e.start_timer($("#sin-se-time-until"),s.seends),$("#sin-se-enter").click(function(t){t.preventDefault(),a(e.preloader_screen),setTimeout(e.proceed_step1.bind(e),500)})})}proceed_step1(){a(this.vote_how_el),o(this.intro_screen),o(this.vote_done_el),o(this.vote_screen),o(this.preloader_screen);var e=$("#sin-se-qor-button"),t=$("#sin-se-nqor-button");e.click(this.proceed_step2.bind(this));var i=this;t.click(function(){i.nqor=!0,i.proceed_finish()})}adjust_frame_size(){this.modal_explain=this.app.mobile;var e=$("#sin-se-comp1"),t=$("#sin-se-comp2");if(this.app.mobile)e.addClass("col-12"),t.addClass("col-0");else{var i=$("body").width();760<i&&i<1555?(e.removeClass("col-md-4 col-12 col-sm-12"),t.removeClass("col-md-8 col-0 com-sm-0"),e.addClass("col-md-6 col-12 col-sm-6"),t.addClass("col-md-6 col-12 col-sm-6")):(e.removeClass("col-md-6 col-12 col-sm-6"),t.removeClass("col-md-6 col-12 col-sm-6"),e.addClass("col-md-4 col-12 col-sm-12"),t.addClass("col-md-8 col-0 com-sm-0"))}var s=$("body").outerHeight(),n=$("#sin-se-position-box").outerHeight(),a=$("#sin-se-instructions").outerHeight(),o=$("#sin-se-position-box").outerHeight(),r=$("#sin-se-rearranger"),l=r.outerHeight()-r.innerHeight(),d=r.innerHeight()-r.height(),c=r.outerHeight(!0)-r.outerHeight();r.css({height:s-(n+a+o+l+d+c)})}proceed_step2(){a(this.preloader_screen),o(this.vote_screen),o(this.vote_how_el),o(this.intro_screen),o(this.vote_done_el);var e=this;this.adjust_frame_size(),$(window).on("resize",this.adjust_frame_size.bind(this)),this.app.db.collection("nominations").get().then(function(t){t.forEach(function(t){var i=t.data();e.nominee_data.push(i)})}).then(function(){a(e.vote_screen),o(e.vote_how_el),o(e.intro_screen),o(e.vote_done_el),o(e.preloader_screen),e.prepare_for_voting(e.nominee_data),e.next_voting()})}submit_votes(){var e=this,t=e.app.db.batch(),n=e.app.db.collection("elections").doc(s.secampaign),a={};Object.keys(this.results).forEach(function(t){a[`Results-${t.replace(/\s/g,"-")}`]={},a[`Results-${t.replace(/\s/g,"-")}`][String(e.results[t])]=i.firestore.FieldValue.increment(1)}),a.users_voted=i.firestore.FieldValue.increment(1),t.set(n,a,{merge:!0}),t.commit().then(function(){console.log("done!!")})}prepare_for_voting(e){var t={};e.forEach(function(e){null==t[e.senate_position]&&(t[e.senate_position]=[]),t[e.senate_position].push(e)}),this.nominations_by_case=t;var i=this;$("#sin-se-submit-button").click(function(){if(null!=i.nominations_by_case){var e=Object.keys(i.nominations_by_case);i.voting_index+1==e.length-1&&$("#sin-se-submit-button").text("Submit");i.nominations_by_case[Object.keys(t)[i.voting_index]];var s=$("#sin-se-items").children(),n="";s.each(function(){var e=atob($(this).attr("data-checksum"));n+=`{${e.replace(/\s/g,"::")}}`}),i.results[Object.keys(t)[i.voting_index]]=n,i.voting_index+1<e.length?i.next_voting():i.proceed_finish()}});var s=$("#sin-se-items");new Sortable(s[0],{animation:150,easing:"cubic-bezier(1, 0, 0, 1)",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",dragoverBubble:!1,fallbackOnBody:!0,forceFallback:!0,onStart:function(e){$(e.item).css("zoom",.8),$("body").addClass("dragging-cursor"),$("body").removeClass("auto-cursor")},onEnd:function(e){$(e.item).css("zoom",1),s.children("div").each(function(e){$(this).find(".sin-se-rank").find("h1").text(e+1)}),$("body").removeClass("dragging-cursor"),$("body").addClass("auto-cursor")}})}next_voting(){this.voting_index++,o($("#sin-se-loading-tab")),o($("#sin-se-data-tab")),this.app.mobile?o($("#sin-se-unopened-tab")):a($("#sin-se-unopened-tab"));var t=$("#sin-se-running-for"),i=$("#sin-se-items"),s=0,n=this,r=Object.keys(this.nominations_by_case),l=r[this.voting_index];t.text(`(${this.voting_index+1}/${r.length}) Running for ${l}...`),i.empty(),this.nominations_by_case[l].forEach(function(e){i.append(u.make_nominee_box(e,++s))}),this.adjust_frame_size(),this.fix_cursor(),$(".sin-se-item").click(function(t){if(console.log(n.app.mobile),n.app.mobile){$("#sin-se-loading-tab").css({width:"100%"}),$("#sin-se-comp2").css({position:"absolute",height:"100%",overflow:"auto",background:"#272c31"});var i=$('<a class="btn btn-warning go-back-btn">Go back</a>');i.click(function(e){e.preventDefault(),o($("#sin-se-data-tab")),$(this).remove()}),$("body").append(i)}a($("#sin-se-loading-tab")),o($("#sin-se-data-tab")),t.preventDefault();var s=atob($(this).attr("data-checksum")),r=n.nominations_by_case[l].filter(e=>e.name==s);if(console.log(r),0!=r.length){var d=r[0];o($("#sin-se-unopened-tab")),a($("#sin-se-loading-tab")),$("#sin-se-data-tab").html(e('<div class="container"><p><i>Why vote for</i></p><h1 class="display-4">{{name}}</h1><hr><p class="lead">{{msg}}</p><small class="text-light">Last updated on {{date}}.</small></div></div>',{name:d.name,msg:d.campaign_msg,school_year:u.get_worded_school_year(d.school_year),date:new Date(1e3*parseInt(d.registered.seconds)).toISOString().substr(0,10)})),setTimeout(function(){o($("#sin-se-loading-tab")),a($("#sin-se-data-tab"))},1e3*Math.random())}})}proceed_finish(){var e=this;o(this.vote_how_el),o(this.intro_screen),o(this.vote_screen),a(this.preloader_screen),setTimeout(function(){a(e.vote_done_el),o(e.preloader_screen),e.submit_votes(),setTimeout(function(){e.app.db.collection("users_who_have_voted_"+s.secampaign).add({Email:e.app.auth.currentUser.email,Time:i.firestore.FieldValue.serverTimestamp()}).then(function(){var t=$("#sin-se-redirect-count");e.start_timer(t,(new Date).getTime()+5e3,function(){window.location.href="./"})})})},300)}start_timer(e,t,i){var s=t,n=setInterval(function(){var t=(new Date).getTime(),a=s-t,o=Math.floor(a/864e5),r=Math.floor(a%864e5/36e5),l=Math.floor(a%36e5/6e4),d=Math.floor(a%6e4/1e3),c="";c+=0!=o?o+"d ":"",c+=0!=r?r+"h ":"",c+=0!=l?l+"m ":"",c+=0!=d?d+"s ":"",e.html(c),a<0&&(clearInterval(n),null!=i&&i.call(),e.text("EXPIRED"))})}_carousel(){var e=document.querySelector("#board");new l(e)}}class l{constructor(e){this.board=e,this.action_wrapper="#wrapper",this.push(),this.push(),this.handle(),this.releasedTaps=0,this.transition_speed=5e3,this.board_colors={DEFAULT:"#ECEFF1",POSITIVE:"#28A745",NEGATIVE:"#DC3545",BOOST:"#E83E8C"},this._center_el(this.action_wrapper),$(window).on("resize",function(){console.log("ddd"),this._center_el(this.action_wrapper)}.call(this))}handle(){this.cards=this.board.querySelectorAll(".card"),this.topCard=this.cards[this.cards.length-1],this.nextCard=this.cards[this.cards.length-2],this.cards.length>0&&(this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(1)",this.hammer&&this.hammer.destroy(),this.hammer=new Hammer(this.topCard),this.hammer.add(new Hammer.Tap),this.hammer.add(new Hammer.Pan({position:Hammer.position_ALL,threshold:0})),this.hammer.on("tap",e=>{this.onTap(e)}),this.hammer.on("pan",e=>{this.onPan(e)}))}onTap(e){let t=15*((e.center.x-e.target.getBoundingClientRect().left)/e.target.clientWidth<.05?-1:1);this.topCard.style.transition="transform 100ms ease-out",this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY("+t+"deg) scale(1)",++this.releasedTaps%2?(this.topCard.classList.remove("card--expanded"),$(this.topCard).animate({scrollTop:0},"fast")):this.isPanning||this.topCard.classList.add("card--expanded"),setTimeout(()=>{this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(1)"},100)}onPan(e){if(!this.isPanning){this.isPanning=!0,this.topCard.style.transition=null,this.nextCard&&(this.nextCard.style.transition=null);let t=window.getComputedStyle(this.topCard).transform.match(/^matrix\((.+)\)$/);this.startPosX=t?parseFloat(t[1].split(", ")[4]):0,this.startPosY=t?parseFloat(t[1].split(", ")[5]):0;let i=this.topCard.getBoundingClientRect();this.isDraggingFrom=e.center.y-i.top>this.topCard.clientHeight/2?-1:1}let t=e.deltaX+this.startPosX,i=e.deltaY+this.startPosY,s=e.deltaX/this.board.clientWidth,n=e.deltaY/this.board.clientHeight,a=e.deltaX<0?-1:1,o=this.isDraggingFrom*a*Math.abs(s)*45,r=(95+5*Math.abs(s))/100;if(this.topCard.style.transform="translateX("+t+"px) translateY("+i+"px) rotate("+o+"deg) rotateY(0deg) scale(1)",this.nextCard&&(this.nextCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale("+r+")"),e.isFinal){this.isPanning=!1;let a=!1;this.topCard.style.transition="transform 200ms ease-out",this.nextCard&&(this.nextCard.style.transition="transform 100ms linear"),s>.25&&e.direction==Hammer.DIRECTION_RIGHT?(a=!0,t=this.board.clientWidth):s<-.25&&e.direction==Hammer.DIRECTION_LEFT?(a=!0,t=-(this.board.clientWidth+this.topCard.clientWidth)):n<-.25&&e.direction==Hammer.DIRECTION_UP&&(a=!0,i=-(this.board.clientHeight+this.topCard.clientHeight)),a?(this.topCard.style.transform="translateX("+t+"px) translateY("+i+"px) rotate("+o+"deg)",setTimeout(()=>{this.board.removeChild(this.topCard),this.push(),this.handle()},200)):(this.topCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(1)",this.nextCard&&(this.nextCard.style.transform="translateX(-50%) translateY(-50%) rotate(0deg) rotateY(0deg) scale(0.95)"))}}push(){let e=document.createElement("div"),t=document.createElement("div");e.classList.add("card");let i=document.createElement("img");i.setAttribute("draggable",!1),i.classList.add("card-img-top"),i.src="https://picsum.photos/286/180/?random="+Math.round(1e6*Math.random()),i.alt=Math.round(1e6*Math.random())+"')";var s=function(e,t,i){for(var s=document.createElement(e),n=document.createTextNode(i),a=0;a<t.length;a++)s.classList.add(t[a]);return null!=typeof i&&s.appendChild(n),s}("H3",["card-title"],"Farming Club"),n=$('<p class="h6"></p>');t.classList.add("lt-cont","card-body");for(var a=[{name:"Parth Raghav",email:"raghavp@reed.edu"},{name:"Nama Shitushah",email:"namas@reed.edu"}],o=0;o<a.length;o++)n.append($("<span>"+a[o].name+" <b>("+a[o].email+")</b></span>")),o<a.length-1&&n.append("<br>");t.appendChild(s),t.appendChild(n[0]),t.appendChild(void 0),e.appendChild(i),e.appendChild(t),this.board.firstChild?this.board.insertBefore(e,this.board.firstChild):this.board.append(e)}_center_el(e){$(e).css("position","absolute"),$(e).css("bottom","10%"),$(e).css("left",Math.max(0,($(window).width()-$(e).outerWidth())/2+$(window).scrollLeft())+"px")}}class d{constructor(e,t){this.views={preloader:"section#preloader-screen",intro:"section#intro-screen",voting:"section#voting-screen"},this.lag=600,this.app=e}call_micro_constructor(e){e==this.views.intro?this._constructor_intro():e==this.views.voting&&this._constructor_voting()}_constructor_intro(){var e=$("#sin-fp-time-until"),t=$("#sin-fp-voter-count"),i=s.fpends,n=setInterval(function(){var t=(new Date).getTime(),s=i-t,a=Math.floor(s/864e5),o=Math.floor(s%864e5/36e5),r=Math.floor(s%36e5/6e4),l=Math.floor(s%6e4/1e3),d="";d+=0!=a?a+"d ":"",d+=0!=o?o+"h ":"",d+=0!=r?r+"m ":"",d+=0!=l?l+"s ":"",e.html(d),s<0&&(clearInterval(n),document.getElementById("demo").innerHTML="EXPIRED")});this.app.db.collection("polls").doc(s.poll_name+"-"+s.poll_id).get().then(function(e){if(e.exists){var i=e.data()["voter-turnout"];t.html(i)}else t.html(0)}).catch(function(e){console.log("Error getting the voter turnout")})}_constructor_voting(){var e=$("#instruction_modal"),t=$("section#voting-screen"),n=$("#sin-fp-likes"),a=$("#sin-fp-dislikes"),o=$("#sin-fp-boosts"),r=0;e.modal("show"),this.app.mobile&&e.animate({scrollTop:jQuery(document).height()},2e3);var l=[],d=[];function c(){var e=0,t=0,i=0;l.forEach(function(s){e+=s.liked?1:0,t+=s.disliked?1:0,i+=s.boosted?1:0}),n.text(e),a.text(t),o.text(i),e+t+i<s.vote_submission_threshold*r?$("#sin-fp-submit-button-container").hide():$("#sin-fp-submit-button-container").show()}$("#sin-fp-submit-button-container").hide(),this.app.db.collection("registered_clubs").doc(s.semester).get().then(function(e){if(e.exists){var t=e.data().registered_clubs;r=t.length,t.forEach(function(e){e.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),l.push({id:e.id,title:e.title,about:e.about,contact:e.contact,signators:e.signators,liked:!1,disliked:!1,boosted:!1});var t=u.generate_club_card(e.id,e.title,e.signators.split(","),e.about,function(){var t=$(this).parents(".pmd-card");t.hasClass("card-success")?(t.removeClass("card-success"),l.find(t=>t.id==e.id).liked=!1,l.find(t=>t.id==e.id).boosted=!1,l.find(t=>t.id==e.id).disliked=!1):(t.removeClass("card-warning"),t.removeClass("card-danger"),t.addClass("card-success"),l.find(t=>t.id==e.id).boosted=!1,l.find(t=>t.id==e.id).disliked=!1,l.find(t=>t.id==e.id).liked=!0),c()},function(){var t=$(this).parents(".pmd-card");t.hasClass("card-danger")?(t.removeClass("card-danger"),l.find(t=>t.id==e.id).liked=!1,l.find(t=>t.id==e.id).boosted=!1,l.find(t=>t.id==e.id).disliked=!1):(t.removeClass("card-warning"),t.removeClass("card-success"),t.addClass("card-danger"),l.find(t=>t.id==e.id).liked=!1,l.find(t=>t.id==e.id).boosted=!1,l.find(t=>t.id==e.id).disliked=!0),c()},function(){var t=$(this).parents(".pmd-card");t.hasClass("card-warning")?(t.removeClass("card-warning"),l.find(t=>t.id==e.id).liked=!1,l.find(t=>t.id==e.id).boosted=!1,l.find(t=>t.id==e.id).disliked=!1):parseInt(o.text())<s.max_boosts?(t.removeClass("card-success"),t.removeClass("card-danger"),t.addClass("card-warning"),l.find(t=>t.id==e.id).liked=!1,l.find(t=>t.id==e.id).disliked=!1,l.find(t=>t.id==e.id).boosted=!0):alert("You can boost at most 6 clubs"),c()});d.push(t)})}}).then(function(){(d=u.shuffle(d)).forEach(e=>t.append(e))});var h=this;window.poll_submit_fn_legay=function(){var e=h.app.db.batch(),t=h.app.db.collection("registered_clubs");l.forEach(function(s){var n,a=s.liked||s.disliked||s.boosted;s.liked?n={votes:i.firestore.FieldValue.increment(1),liked:i.firestore.FieldValue.increment(1)}:s.disliked?n={votes:i.firestore.FieldValue.increment(-1),disliked:i.firestore.FieldValue.increment(1)}:s.boosted&&(n={votes:i.firestore.FieldValue.increment(4),boosted:i.firestore.FieldValue.increment(1)}),a&&e.set(t.doc(s.id),n,{merge:!0})}),e.set(h.app.db.collection("polls").doc(s.poll_name+"-"+s.poll_id),{"voter-turnout":i.firestore.FieldValue.increment(1)},{merge:!0}),e.commit().then(function(){console.log("vote committed!")}).then(h.app.db.collection("users_who_have_voted").add({Email:h.app.auth.currentUser.email,Time:i.firestore.FieldValue.serverTimestamp()})).then(function(){alert("your vote has been registered! Thank you for participating in the funding poll!"),window.location.reload()})},$("#sin-fp-submit-button").click(function(){var e=[];h.app.db.collection("registered_clubs").doc(s.semester).get().then(function(t){if(t.exists){var i=t.data().registered_clubs;l.forEach(function(e){e.liked||e.disliked||e.boosted;var t,s=(t=e,i.findIndex(e=>e.title==t.title&&e.signators==t.signators));console.log(s,i,e);var n=e.liked?1:0,a=e.disliked?1:0;i[s].liked+=n,i[s].disliked+=a,i[s].votes+=n-a}),e=i,console.log(e)}}).then(function(){h.app.db.collection("registered_clubs").doc(s.semester).update({registered_clubs:e}).then(function(){console.log("vote committed"),h.app.db.collection("users_who_have_voted").doc(s.poll_name+"-"+s.poll_id).set({voters:i.firestore.FieldValue.arrayUnion({Email:h.app.auth.currentUser.email,Time:(new Date).getTime()})}).then(function(){h.app.db.collection("polls").doc(s.poll_name+"-"+s.poll_id).update({"voter-turnout":i.firestore.FieldValue.increment(1),voters:i.firestore.FieldValue.arrayUnion(h.app.auth.currentUser.email)}).then(function(){alert("your vote has been registered! Thank you for participating in the funding poll!"),window.location.reload()})})})})})}switch(e){function t(e){if(Object.values(this.views).map(e=>$(e)[0]).includes($(e)[0]))for(const s in this.views){var t=$(this.views[s])[0],i=$(e)[0];i==t?(i.classList.remove("d-none"),i.classList.add("d-"+i.getAttribute("data-display"))):(t.classList.remove("d-"+t.getAttribute("data-display")),t.classList.add("d-none"))}this.call_micro_constructor(e)}var i,s;e!=this.views.preloader&&this.lag>0&&t.bind(this)(this.views.preloader),setTimeout((i=t.bind(this),s=e,i.call(s)),this.lag/2);var n=this;return setTimeout(function(){t.bind(n)(e)},Math.floor(Math.random(this.lag)+this.lag/2)),this}async wait(e){var t,i,s=this;return await(t=e,i=s,new Promise(e=>setTimeout(function(){return s}.bind(i),t)))}}class c{constructor(e){this.app=e,this.viewer=new d(this.app);var t=this.viewer.views;this.viewer.switch(t.intro),this.init_intro_screen()}init_intro_screen(){var e=document.getElementById("fp-enter"),t=document.getElementById("fp-exit");e.onclick=(()=>this.viewer.switch(this.viewer.views.voting)).bind(this),t.onclick=function(){window.location.href==document.referrer?window.location.href="http://www.studentbody.com/":window.location.href=document.referrer}}}class u{static get_worded_school_year(e){return["First-year Student","Sophomore","Junior","Senior"][parseInt(e)-1]}static make_nominee_box(e,t){var i,s=(4-parseInt(e.school_year)+(new Date).getFullYear())%100,n=parseInt(e.votes);return 0==n?i="Be the first one to vote for them.":1==n?i="1 other person voted for them.":n>1&&(i=`${n} other people voted for them.`),`\n          <div class="m-1 grabbable sin-se-item row no-gutters" data-checksum=${btoa(e.name)}>\n            <div class="col-2 col-sm-2 col-md-2 card sin-se-rank rounded-0">\n                <h1 class="align-middle my-auto">${t}</h1>\n            </div>\n            <div class="col-10 col-sm-10 col-md-7 sin-se-details">\n                <div class="card-body text-left">\n                    <h1 class="card-title mb-0">${e.name} '${s}</h1>\n                    <p class="card-text sin-se-description mb-0">${TFIDF(e.campaign_msg)}</p>\n                    <p class="card-text mb-0"><small class="text-muted">${i}</small></p>\n                </div>\n            </div>\n            <div class="col-0 col-xs-0 col-sm-0 d-none d-sm-none d-xs-none col-md-3 container d-md-flex sin-se-photo">\n                <img src="${e.photoURL}" class="card-img text-center justify-content-center align-self-center mx-0 mx-auto" alt="...">\n            </div>\n            <div class="col-md-12 sin-se-placeholder"></div>\n          </div>\n          `}static congratulatory_confetti(){var e=!1;$(function(){var t=$(window),i=Math.random,s=Math.cos,n=Math.sin,a=Math.PI,o=2*a,r=300,l=void 0,d=[],c=[38,38,40,40,37,39,37,39,66,65],h=0,p=50,m=3,f=25-m,g=100,v=-.1,b=-v-v,_=.13,w=.18,y=.4,x=.7-y,k=u.shuffle(["#FF9800","#A52A2A","#5F9EA0","#FF7F50","#EF5350","#7E57C2","#2196F3","#00BCD4","#009688","#CDDC39","#808080","#FFC0CB","#9acd32","#ee82ee","#ff6347","#008080","#009688","#6a5acd","#4169e1"]).map(function(e){return function(){return e}});k=[function(){return C(200*i()|0,200*i()|0,200*i()|0)},function(){var e=200*i()|0;return C(200,e,e)},function(){var e=200*i()|0;return C(e,200,e)},function(){var e=200*i()|0;return C(e,e,200)},function(){return C(200,100,200*i()|0)},function(){return C(200*i()|0,200,200)},function(){var e=256*i()|0;return C(e,e,e)},function(){return k[i()<.5?1:2]()},function(){return k[i()<.5?3:5]()},function(){return k[i()<.5?2:4]()}];function C(e,t,i){return"rgb("+e+","+t+","+i+")"}var F=.1,E=F+F;var L=document.createElement("div");function T(e){this.frame=0,this.outer=document.createElement("div"),this.inner=document.createElement("div"),this.outer.appendChild(this.inner);var r=this.outer.style,l=this.inner.style;r.position="absolute",r.width=m+f*i()+"px",r.height=m+f*i()+"px",l.width="100%",l.height="100%",l.backgroundColor=e(),r.perspective="50px",r.transform="rotate("+360*i()+"deg)",this.axis="rotate3D("+s(360*i())+","+s(360*i())+",0,",this.theta=360*i(),this.dTheta=y+x*i(),l.transform=this.axis+this.theta+"deg)",this.x=t.width()*i(),this.y=-g,this.dx=n(v+b*i()),this.dy=_+w*i(),r.left=this.x+"px",r.top=this.y+"px",this.splineX=function(){for(var e=[F,1-F],t=1-E,s=[0,1];t;){var n,a,o,r,l,d,c,u=t*i();for(n=0,a=e.length,t=0;n<a;n+=2){if(r=e[n],u<t+(o=(l=e[n+1])-r)){s.push(u+=r-t);break}t+=o}for(d=u-F,c=u+F,n=e.length-1;n>0;n-=2)r=e[a=n-1],l=e[n],r>=d&&r<c?l>c?e[a]=c:e.splice(a,2):r<d&&l>d&&(l<=c?e[n]=d:e.splice(n,0,d,c));for(n=0,a=e.length,t=0;n<a;n+=2)t+=e[n+1]-e[n]}return s.sort()}(),this.splineY=[];for(var d=1,c=this.splineX.length-1;d<c;++d)this.splineY[d]=g*i();this.splineY[0]=this.splineY[c]=g*i(),this.update=function(e,t){this.frame+=t,this.x+=this.dx*t,this.y+=this.dy*t,this.theta+=this.dTheta*t;for(var i=this.frame%7777/7777,d=0,c=1;i>=this.splineX[c];)d=c++;var u,h,p,m=(u=this.splineY[d],h=this.splineY[c],p=(i-this.splineX[d])/(this.splineX[c]-this.splineX[d]),(1-s(a*p))/2*(h-u)+u);return i*=o,r.left=this.x+m*s(i)+"px",r.top=this.y+m*n(i)+"px",l.transform=this.axis+this.theta+"deg)",this.y>e+g}}function D(){if(!l){document.body.appendChild(L);var s=k[e?k.length*i()|0:0],n=0;!function t(){if(e&&++n>p)return r=void 0;var i=new T(s);d.push(i),L.appendChild(i.outer),r=setTimeout(t,100)}();var a=void 0;requestAnimationFrame(function e(i){var s=a?i-a:0;a=i;for(var n=t.height(),o=d.length-1;o>=0;--o)d[o].update(n,s)&&(L.removeChild(d[o].outer),d.splice(o,1));if(r||d.length)return l=requestAnimationFrame(e);document.body.removeChild(L),l=void 0})}}L.style.position="fixed",L.style.top="0",L.style.left="0",L.style.width="100%",L.style.height="0",L.style.overflow="visible",L.style.zIndex="9999",t.keydown(function(e){(h=c[h]===e.which?h+1:+(e.which===c[0]))===c.length&&(h=0,D())}),e||D()})}static visualise_results(e){e=e.sort(function(e,t){return d3.ascending(e.votes,t.votes)});var t=15,i=200,s=15,n=300,a=Math.max(500,window.innerWidth-2*(n+i)),o=1.5*window.outerHeight-t-s,r=d3.select("#sin-fp-results-graphic").append("svg").attr("width",a+n+i).attr("height",o+t+s).append("g").attr("transform","translate("+n+","+t+")"),l=d3.scale.linear().range([0,a]).domain([0,d3.max(e,function(e){return e.votes})]),d=d3.scale.ordinal().rangeRoundBands([o,0],.3).domain(e.map(function(e){return e.title})),c=d3.svg.axis().scale(d).tickSize(0).orient("left"),u=(r.append("g").attr("class","y axis").call(c).selectAll("text").attr("transform",function(e){return"rotate(05)"}),r.selectAll(".bar").data(e).enter().append("g"));u.append("rect").attr("class",function(t,i){return e.length-i<40?"bar top40":"bar "}).attr("y",function(e){return d(e.title)}).attr("height",d.rangeBand()).attr("x",0).attr("width",function(e){return l(e.votes)}),u.append("text").attr("class","label").attr("y",function(e){return d(e.title)+d.rangeBand()/2+4}).attr("x",function(e){return l(e.votes)+3}).text(function(e){return e.votes})}static format_budget_row(e){var t,i,s=$("<table>").addClass("p-3","display").attr({width:"80%",border:"4px solid #212529",cellspacing:0}).css({margin:"0px auto"}),n=$("<tbody></tbody>"),a=0;for(a=0;a<e.budget.length;a++)t=$("<tr></tr>"),i=e.budget[a],t.append($("<th>"+i.item+"</th>")),t.append($("<th>"+i.category+"</th>")),t.append($("<th>$"+i.amount+"</th>")),n.append(t);var o=e.description,r="mailto:"+e.signators+"?subject="+encodeURIComponent("Re: Fund Request")+"&body="+encodeURIComponent("Hi,\n\nYou requested $"+e.total+" from the Student Body Senate. "),l=$(`<div class="row exp-row"><div class="col-md-12 fin-dd-fopen-about p-3">${o}</div></div>`),d=$(`<div class="row exp-row d-flex justify-content-center">\n\n            <div class="input-group input-group-lg mb-3" width="80%">\n              <div class="input-group-prepend">\n                <span class="input-group-text">$</span>\n              </div>\n              <input type="text" cl class="form-control" placeholder="How much fund to allocate?" aria-label="Recipient's username" aria-describedby="basic-addon2">\n              <div class="input-group-append">\n            <a class="btn btn-warning shoot_email" data-link='${r}'><i class="fas fa-paper-plane"></i> Shoot Email</a>\n              </div>\n            </div>\n\n\n            </div>`);return n.append(l),s.append(n),s.append(d),s.css({"padding-bottom":"30px !important"}),s.get(0).outerHTML}static format_club_row(e){var t=$("<div>").addClass("p-3");"about"in e&&(t.append("<h4>About the club</h4>"),t.append('<div class="fin-dd-fopen-about">'+e.about+"</div>"),t.append("<br>")),1==e.identity_request&&(t.append("<h4>Identity Status Application</h4>"),t.append('<h5 class="ml-3">Mission Statement</h5>'),t.append('<div class="ml-5 fin-dd-fopen-about fin-dd-read-more">'+e.identity_mission+"</div>"),t.append('<h5 class="ml-3">Community Building</h5>'),t.append('<div class="ml-5 fin-dd-fopen-about fin-dd-read-more">'+e.identity_community+"</div>"),t.append('<h5 class="ml-3">Supporting Activities/Events</h5>'),t.append('<div class="ml-5 fin-dd-fopen-about fin-dd-read-more">'+e.identity_activity+"</div>"),t.append('<h5 class="ml-3">Inclusivity</h5>'),t.append('<div class="ml-5 fin-dd-fopen-about fin-dd-read-more">'+e.identity_open+"</div>"),t.append('<h5 class="ml-3">Outside Funding</h5>'),t.append('<div class="ml-5 fin-dd-fopen-about fin-dd-read-more">'+e.identity_outsidefunding+"</div>"));var i=$('<a class="btn btn-success text-light m-1">Mark as reviewed</a>');$('<a class="btn btn-danger text-light m-1">Remove from Funding Poll</a>');return i.click(function(){}),t.get(0).outerHTML}static itemiser(){var e=[1,4,3,3,1],t=[{text:"Select...",value:0,bg_color:"#FFFFFF",text_color:"#000000"},{text:"Refreshments",value:1,bg_color:"#009688",text_color:"#FFFFFF"},{text:"Administration",value:2,bg_color:"#3F51B5",text_color:"#FFFFFF"},{text:"Entertainment",value:3,bg_color:"#9C27B0",text_color:"#FFFFFF"},{text:"Capital Improvements",value:4,bg_color:"#673AB7",text_color:"#FFFFFF"},{text:"A/V",value:5,bg_color:"#FF5722",text_color:"#FFFFFF"},{text:"Miscellaneous",value:6,bg_color:"#E91E63",text_color:"#FFFFFF"}];var i=0,s=$("#sin-rf-add-item"),n=$("#sin-rf-item-header"),a=$("#sin-rf-item-footer"),o=$("#sin-rf-empty-cart");function r(e,t=!1){t||e[0].classList.remove("d-block"),e[0].classList.add("d-none")}function l(e,t=!1){t||e[0].classList.add("d-block"),e[0].classList.remove("d-none")}function d(e){return e.is(":visible")}0==i&&(l(o),r(n,!0)),s.click(function(s){s.preventDefault();var c=function(s){function a(t){return $('<div class="col-'+e[t-1]+'"></div>')}var c,u,h,p,m;(c=a(1)).addClass("sin-rf-item-hash"),c.html(s),(u=a(2)).append($("<input/>").attr({name:"sin-rf-item-name-"+s,id:"sin-rf-item-name-"+s,class:"form-control sin-rf-item-name",placeholder:"Item",ariaLabel:"Item"})),h=a(3);var f=$("<select>").attr({name:"sin-rf-choose-category"+s,id:"sin-rf-choose-category"+s,class:"form-control sin-rf-item-category"});f.change(function(){var e=$(this).val(),i=t.find(t=>t.value==e);$(this).css({background:i.bg_color,color:i.text_color})}),h.append(f),$.each(t,function(e,t){var i=$("<option>");i.html(t.text),f.append(i.attr({value:t.value}))}),p=a(4);var g=$('<div class="input-group mb-3"><div class="input-group-prepend"><span class="input-group-text">$</span></div><input type="number" class="form-control sin-rf-item-cost" placeholder="Amount" step="0.01" aria-label="Amount" name="sin-rf-item-cost-'+s+'" id="sin-rf-item-cost-'+s+'"></div>');p.append(g),m=a(5);var v=$("<a>").attr({href:"#",class:"text-danger"});v.html('<i class="fa fa-times"></i>'),v.click(function(e){e.preventDefault();var t=$(this).parents(".sin-rf-item-row").find(".sin-rf-item-cost").val();$(this).parents(".sin-rf-item-row").remove(),i-=1,$(".sin-rf-item-hash").each(function(e){$(this).html(e+1)}),0==i&&(d(n)&&r(n),d(o)||l(o));var s=parseFloat($("#sin-rf-item-cost-final").val())-parseFloat(t);$("#sin-rf-item-cost-final").val(parseFloat(s).toFixed(2))}),m.append(v);var b=$("<div>").attr({class:"row sin-rf-item-row",id:"sin-rf-item-row-"+s});return b.append(c).append(u).append(h).append(p).append(m),b}(i+1);a.before(c),(i+=1)>0&&(d(n)||l(n,!0),d(o)&&r(o)),$(".input-group").off(),$(".input-group").on("input",".sin-rf-item-cost",function(){var e;$("#sin-rf-item-cost-final").val(parseFloat((e=0,$(".input-group .sin-rf-item-cost").each(function(){var t=$(this).val();$.isNumeric(t)&&(e+=parseFloat(t))}),e)).toFixed(2))})})}static make_purpose_selector(e){$(e).selectize({create:!0,sortField:"text"})}static make_reserve_selector(e){$(e).selectize({create:!0,sortField:"text"})}static make_organisation_selector(e,t){var i=t.sort(function(e,t){return e.title<t.title?-1:e.title>t.title?1:0});$.each(i,function(t,i){$(e).append($("<option>",{value:i.title,text:i.title}))});var s=$(e).children().toArray().sort();$(e).append(s),$(e).selectize({create:!0,sortField:"text"})}static make_senate_position_selector(e,t){console.log(t[0]);var i=0,s=[],n=["badge-primary","badge-success","badge-danger","badge-warning","badge-info"];$(e).selectize({create:!0,maxItems:1,sortField:"Role",valueField:"Role",labelField:"Count",optgroups:["Primary"],optgroupValueField:["Primary"],optgroupField:"Primary",searchField:["Role"],placeholder:"Click/Type to choose a senate position",options:t,render:{item:function(e,t){var s;return console.log(e),e.Primary?s="badge-light":(s=n[(n.length-1)%i],i+=1),"<div>"+(e.Role?'<span class="sin-rfs-name">'+t(e.Role)+"</span>":"")+(e.Count||e.Primary?` <span class="sin-rfs-email badge ${s}"> `+t(e.Count)+" in running </span>":"")+"</div>"},option:function(e,t){var s;return console.log(e),e.Primary?s="badge-light":(s=n[(n.length-1)%i],i+=1),"<div>"+(e.Role?'<span class="sin-rfs-name">'+t(e.Role)+"</span>":"")+(e.Count||e.Primary?` <span class="sin-rfs-email badge ${s}"> `+t(e.Count)+" in running </span>":"")+"</div>"}},create:function(e){t.concat(s);if(!t.map(e=>e.Role.toLowerCase()).includes($.trim(e.toLowerCase()))){var i={Role:$.trim(e),Count:0,Primary:!1};return s.push(i),i}return alert("Position with the same name already exists."),!1}})}static make_signator_selector(e,t){var i="([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";$(e).selectize({persist:!1,maxItems:null,valueField:"Email",labelField:"Name",searchField:["Name","Email"],options:t,render:{item:function(e,t){return"<div>"+(e.Name?'<span class="sin-rc-name">'+t(e.Name)+"</span>":"")+(e.Email?'<span class="sin-rc-email">'+t(e.Email)+"</span>":"")+"</div>"},option:function(e,t){var i=e.Name||e.Email,s=e.Name?e.Email:null;return'<div><span class="label">'+t(i)+"</span> "+(s?'[<i><span class="caption">'+t(s)+"</span></i>]":"")+"</div>"}},createFilter:function(e){var t,s;return s=new RegExp("^"+i+"$","i"),(t=e.match(s))?!this.options.hasOwnProperty(t[0]):(s=new RegExp("^([^<]*)<"+i+">$","i"),!!(t=e.match(s))&&!this.options.hasOwnProperty(t[2]))},create:function(e){if(new RegExp("^"+i+"$","i").test(e))return{email:e};var t=e.match(new RegExp("^([^<]*)<"+i+">$","i"));return t?{Email:t[2],Name:$.trim(t[1])}:(alert("Invalid email address."),!1)}})}static is_mobile(){var e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(e=!0),e}static shuffle(e){for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}static show_alert(e,t){$("#sin-fp-alert-placeholder").append('<div id="alertdiv" class="alert alert-'+t+'"><a class="close" data-dismiss="alert"></a><span>'+e+"</span></div>"),setTimeout(function(){$("#sin-fp-alert-placeholder").remove()},5e3)}static generate_club_card(e,t,i,s,n,a,o){var r=$('<div class="pmd-card-figure fp-item col d-inline-flex mx-auto"></div>').attr({id:e}),l=$('<div class="pmd-card pmd-card-default pmd-z-depth pmd-card-custom-view"></div>'),d=$('<div class="pmd-card-title d-flex flex-column"></div>'),c=$('<div class="media-body media-middle"></div>'),u=$('<h1 class="pmd-card-title-text"></h1>').text(t);c.append(u),c.append($("<br>"));var h=$("<div></div>");i.forEach(function(e){h.append($("<span><i>("+e+")</i></span>")),h.append($("<br>"))}),c.append(h);var p=$('<div class="pmd-card-body"></div>');p.text(s);var m=$(' <div class="pmd-card-actions"></div>'),f=$('<button class="btn btn-danger pmd-btn-fab pmd-ripple-effect btn-primary" type="button"><i class="fa fa-thumbs-down"></i></button>'),g=$('<button class="btn btn-success pmd-btn-fab pmd-ripple-effect btn-primary" type="button"><i class="fa fa-thumbs-up"></i></button>'),v=$('<button class="btn btn-warning pmd-btn-fab pmd-ripple-effect btn-primary" type="button"><i class="fa fa-star"></i></button>');return f.click(a),g.click(n),v.click(o),m.append(f),m.append(g),m.append(v),d.append(c),d.append(p),d.append(m),l.append(d),r.append(l),r}}class h{static resolveListRepeats(t,i){$("[data-list-repeat]").each(function(s){if("true"!=$(this).attr("data-list-resolved")){var n=$(this).attr("data-list-repeat"),a=n,o="div";n.indexOf("|")>-1&&(a=n.substr(0,n.indexOf("|")),o=n.substr(n.indexOf("|")+1)),-1==Object.keys(t).indexOf(a)&&console.error("List ["+a+"] does not exist in the local datastore.");var r,l,d=$(this).find(o)[0].outerHTML;$(this).children(o).remove(),console.log(d),console.log(t[a][0]);for(var c=0;c<t[a].length;c++)r=t[a][c],Object.keys(i).forEach(function(e){var t=i[e];Object.keys(r).includes(e)&&(r[e]=t(r[e]))}),l=e(d,r.data),console.log(r),console.log(l),$(this).append(l);$(this).attr("data-list-resolved","false")}})}static ActivateTouchDown(){var e;(e=$)(window).scroll(function(){e(this).scrollTop()>220?e(".atw-down").fadeOut(500):window.innerHeight+window.pageYOffset>=document.body.offsetHeight-60||e(".atw-down").fadeIn(500)}),e(".atw-down").click(function(t){return t.preventDefault(),e("html, body").animate({scrollTop:e(document).height()},500),!1}),e(".atw-down").css("left",$(window).width()/2-e(".atw-down").width()/2),e(window).on("resize",function(){var t=$(this);e(".atw-down").css("left",t.width()/2-e(".atw-down").width()/2)})}static ActivateStickyHeader(){!function(e,t,i){var s="lazy-head--hidden",n=e.querySelector(".lazy-head");if(!n)return!0;var a,o,r,l,d=0,c=0,u=0,h=0,p=0,m=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},f=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")};t.addEventListener("scroll",(a=500,o=function(){d=e.body.offsetHeight,c=t.innerHeight,u=t.pageYOffset,p=h-u,u<=0?f(n,s):p>0&&m(n,s)?f(n,s):p<0&&(u+c>=d&&m(n,s)?f(n,s):function(e,t){e.classList?e.classList.add(t):e.className+=" "+t}(n,s)),h=u},function(){var e=this,t=arguments,i=+new Date;r&&i<r+a?(clearTimeout(l),l=setTimeout(function(){r=i,o.apply(e,t)},a)):(r=i,o.apply(e,t))}))}(document,window);$("nav#sin-app-header").addClass("lazy-head"),function(e,t,i,s){var n="lazy-head--hidden",a=e(".lazy-head");if(!a.length)return!0;var o,r,l,d,c=e(t),u=0,h=0,p=0,m=0,f=e(i),g=0;c.on("scroll",(o=500,r=function(){g=f.height(),u=c.height(),h=c.scrollTop(),m=p-h,h<=0?a.removeClass(n):m>0&&a.hasClass(n)?a.removeClass(n):m<0&&(h+u>=g&&a.hasClass(n)?a.removeClass(n):a.addClass(n)),p=h},function(){var e=this,t=arguments,i=+new Date;l&&i<l+o?(clearTimeout(d),d=setTimeout(function(){l=i,r.apply(e,t)},o)):(l=i,r.apply(e,t))}))}($,window,document)}static ActivateHoverFluid(){var e=["F44336","E91E63","CE93D8","9575CD","3F51B5","03A9F4","00BCD4","009688","4CAF50","8BC34A","CDDC39","FFEB3B","FFC107","FF9800","FF5722","000000"],t=["000000","000000","000000","000000","FFDF00","000000","000000","000000","000000","000000","000000","000000","000000","000000","000000","FFDF00"];$.fn.hoverfluid=function(i){var s,n=$(this);n.hover(function(){var n=Math.floor(Math.random()*(e.length-1));$(i,this).show().css({display:"block",color:"#"+t[n],background:"#"+e[n],border:"1px solid #"+t[n]}),s=$(this).position()},function(){$(i,this).hide().removeAttr("style")}).mousemove(function(e){var t=s.left+e.offsetX+10,n=s.top+e.offsetY+20;$(i,this).show().css({top:n,left:t})})},$('[data-hover-active="true"]').hoverfluid(".hover-fluid-box")}}class p{constructor(e){this.auth_profile=e}request_funds(){const e=document.querySelector("#fund-form");e.addEventListener("submit",function(t){t.preventDefault();e["user-name"].value,e["user-email"].value,e["fund-purpose"].value,e["fund-requested"].value})}}function m(e){this.$element=$(e),this.$content=this.$element.find(".modal-content");var t=this.$content.outerHeight()-this.$content.innerHeight(),i=$(window).width()<768?20:60,s=$(window).height()-(i+t)-((this.$element.find(".modal-header").outerHeight()||0)+(this.$element.find(".modal-footer").outerHeight()||0));this.$content.css({overflow:"hidden"}),this.$element.find(".modal-body").css({"max-height":s,"overflow-y":"auto"})}$(".modal").on("show.bs.modal",function(){$(this).show(),m(this)}),$(window).resize(function(){0!=$(".modal.in").length&&m($(".modal.in"))}),null==window.localStorage.reloaded&&(window.localStorage.reloaded=!0,window.location.reload(!0)),$(document).ready(function(){null==window.localStorage.reloaded2&&(window.localStorage.reloaded2=!0,window.location.reload(!0));new n})}();